---
title: "cp5"
output: html_document
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(viridis)
library(broom)
library(modelr)
library(plotly)

knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 6,
                      fig.height = 5,
                      echo = FALSE)

paleta = c("#404E4D",
           "#92DCE5",
           "#938BA1",
           "#2D3142",
           "#F4743B")
```

```{r}
dados = merge(readr::read_csv(here::here("data/speed-dating.csv")), readr::read_csv(here::here("data/speed-dating2.csv")))
dados <- dados %>% filter(complete.cases(.))
dados <- dados %>% mutate(diferenca_idade = age_o - age) 
dados$diferenca_idade <- abs(dados$diferenca_idade/10)
```
# Likes vs Variáveis do modelo

Queremos ver o quanto o gostar do encontro, isto é a variável dependente `like`, pode ser explicada pelas variáveis independentes que foram preenchidas no formulário. Nos gráficos abaixo podemos ver a interação da variável escolhida e o gostar do encontro, junto de alguma justificativa para escolha da variável.

### Likes x índice de correlaçao de atividade

Algumas dessas variáveis são atividades como `yoga`,`hiking`, entre outras, são resumidas em outra variável, a `int_corr`, que seria o índice de correlação entre os interesses dos participantes do dating. Desta forma, é plausível já utilizar esse índice no cálculo do modelo. 

```{r}
ggplotly(dados %>% ggplot(aes(x=like,y=int_corr)) + geom_count())
```

Com uma análise superficial, vemos que um índice de correlação positivo, isto é, interesses mais similares, evidencia, ao menos graficamente, uma maior quantidade de `like`. 

### Likes x Raça

Em vários locais do mundo o racismo é um problema latente. Os dados foram obtidos nos Estados Unidos, onde recentemente os conflitos raciais foram mais uma vez incendiados. Será que a raça do parceiro no dating influencia em gostar ou não do encontro?

```{r}
ggplotly(dados %>% ggplot(aes(x=like,y=race)) + geom_count())
```

#### E se for da mesma raça?

Se os participantes são da mesma raça, curiosamente, a quantidade de likes é levemente maior quando existe diferença de raça.  

```{r}
ggplotly(dados %>% ggplot(aes(x=like,y=samerace)) + geom_count())
```

### Likes x Diferença de idade

```{r}
ggplotly(dados %>% ggplot(aes(x=like,y=diferenca_idade)) + geom_count())
```

## O modelo

```{r}
modelo_likes = lm(like ~ int_corr + race + samerace + shar + diferenca_idade, 
               data = dados)

tidy(modelo_likes, conf.int=TRUE)
```